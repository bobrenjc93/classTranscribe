[{"text":"[nothing]","width":768},{"text":"yes?","width":256},{"text":"correct, it's not necessarily like a queue","width":320},{"text":"it's actually operating system dependant","width":128},{"text":"we can give hints to the system as to how fair it should be","width":128},{"text":"for example, you might say that the thread that's been waiting the longest should have access to the pizza, that seems pretty fair to me","width":704},{"text":"but actually we have different definitions of fairness","width":256},{"text":"for example, the surgeon that is waiting to eat the pizza has a higher priority than the non-surgeon","width":576},{"text":"so we can actually assign different [gibberish] to our threads","width":192},{"text":"but that's some more advanced stuff that we don't need to worry about for today. for now just assume that you don't control it, the operating system controls who gets to eat the slice of pizza","width":704},{"text":"I don't know about you, but I'm going to be pretty hungry after this lecture","width":448},{"text":"so, yes?","width":448},{"text":"haha, great question! can you use this to implement lock? that's such a great question, I was about to ask it to!","width":384},{"text":"can we use a counting a semphore to implement a lock, a mutex lock? in other words, if I hadn't told you about the mutex lock, could you do it with a counting semaphore?","width":1024},{"text":"that's true, yes, so counting semaphores are more versatile in that sense","width":320},{"text":"but in terms of the counting gold example I showed you at the beginning of this lecture could you do it using a counting semaphore?","width":640},{"text":"well the answer is yes","width":128},{"text":"my next question to you though is what should be the initial value of the counting semaphore?","width":640},{"text":"so if we were to go back to our code here","width":512},{"text":"and we didn't want to use lock and unlock, but we wanted to replace this with a counting semaphore","width":512},{"text":"ok, so, before entering our critical section we should try to take a pizza slice, we want to grab a slice of pizza","width":896},{"text":"ok, how do I do that?","width":192},{"text":"I'm going to call sem_wait() on my counting semaphore","width":384},{"text":"afterwards I can give back the slice of pizza","width":448},{"text":"yeah, sem_post()","width":704},{"text":"so how does that work now?","width":192},{"text":"if I have two threads trying to call sem_wait() at any one time I just need to make sure one of them wins","width":576},{"text":"so therefore how many slices should I put in the pizza box at the begnning? ","width":320},{"text":"just one! yes, so one thread get's a slice of pizza and can continue","width":384},{"text":"if I put in zero slices of pizza when I initialized my program what would happen?","width":512},{"text":"deadlock, yeah! no one gets to continue","width":256},{"text":"if I put in two slices of pizza or more I have a race condition again","width":640},{"text":"now I've let two threads continue when in fact I only ever wanted one thread inside my critical section","width":384},{"text":"if I'd put in two slices of pizza then two threads would've been able to proceed past that sem_wait() at the same time","width":448},{"text":"and that as we say lead to data corruption","width":512},{"text":"ok, so I think I have my sem_wait","width":640},{"text":"man page search","width":576},{"text":"so, when you initialize a semaphore the last thing you're going to pass in is it's initial value, in other words the number of pizza slices inside your counting semaphore","width":1408},{"text":"questions?","width":320},{"text":"so one of the powers of the counting semaphore is that you can call sem_wait() and sem_post from arbirtary threads","width":640},{"text":"and we'll see that when we want to make a simple queue or stack work with multi-threaded code","width":448},{"text":"now, the queues and stacks that you've made in past classes did things like 'oh look I've ran out of space, I know iI'll just allocate some more memory and I'll make my list or linked list longer'","width":896},{"text":"I'll double the number of spaces","width":256},{"text":"we can do better, what we can do is say I will stop thread from putting anything else into my data structure","width":704},{"text":"I can pause it because when it calls sem_wait() we know that it's going to be put on ice","width":448},{"text":"so it's unable to continue, it's unable to put anything else into my data structure until the space","width":448},{"text":"so now I can think of my processing in terms of pipes","width":320},{"text":"and I don't have to have an infinite amount of memory if part of my computation is generating results faster than the rest of my computational process","width":768}]