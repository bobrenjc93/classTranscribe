[{"text":"okay so we did not see hello in our output","width":256},{"text":"but if we have a look down here we'll see we've got a program called log.txt","width":384},{"text":"let's have a look at log.txt","width":128},{"text":"and it says oh okay it seems to be working, let's see if it appends to it","width":512},{"text":"and then it says hello hello alright so we're appending stuff to our log file","width":320},{"text":"we've changed the output of our process to go to this file","width":320},{"text":"now why is it that that happened?","width":192},{"text":"well if we were to read the man page carefully enough about open","width":192},{"text":"it says it returns the lowest non-negative integer","width":256},{"text":"for a file descriptor and we just closed one","width":256},{"text":"so when we do this, it's going to open file descriptor one","width":384},{"text":"which is what everything then uses when you call puts, printf, etc","width":320},{"text":"so we've now just changed our standard output to go to a file","width":192},{"text":"right then we call chdir, what does chdir do, it has nothing to do with cheese","width":896},{"text":"change directory! yes, our core process not only has memory for say the variables that we create","width":576},{"text":"we've got other things inside our process","width":128},{"text":"we've just seen one thing, which is it's got these file descriptors","width":256},{"text":"each process has file descriptors","width":128},{"text":"also each process has a current directory","width":192},{"text":"so when we say hey I want to open a file called log.txt and we haven't specified it's full path","width":448},{"text":"it's relative to its current directory","width":128},{"text":"so for example, if I had put up here \"hey chdir and let's change our directory to just kind of slash\"","width":768},{"text":"okay, let's run this","width":256},{"text":"then slash is the root directory and if we look at the root of our disk drive, now we've managed to make a file called log.txt","width":832},{"text":"here we go and it's contents is just hello hello","width":320},{"text":"right so okay what have we done? we've done chdir. so we've said chrdir to usr/include","width":896},{"text":"let's just have a quick look inside there because what is inside ls /usr/include/","width":320},{"text":"a whole lot of dot h files","width":192},{"text":"remember in your c files and your c++ files when you say #include std.io hash include this hash include that","width":448},{"text":"they are just files, here they are!","width":192},{"text":"so next time your friend walks away, why not edit one of them?","width":704},{"text":"uh do I have vim on this machine? maybe I have stdlib.h","width":384},{"text":"oh I need to be inside that directory","width":128},{"text":"okay cd /usr/include/","width":192},{"text":"let's so stdlib.h and it's a bit of a mess but nevermind","width":448},{"text":"we can say things like whoops not working, not implemented anyways...","width":768},{"text":"we can do #define if while","width":512},{"text":"so if you hash define if while, that means anytime you see an if, it's going to replace that with the letters w h i l e","width":576},{"text":"very useful if your class is curved, right","width":320},{"text":"alright so we've talked about chdir and we've talked about /usr/include","width":512},{"text":"now we can have some fun, so we have this, let's just go back to my original directory","width":320},{"text":"uh hello, alright I'll reboot the machine","width":512},{"text":"right so we have this exec exec thing okay here we go","width":512},{"text":"what does exec do?","width":320},{"text":"alright suppose you were thinking about something, you're running a program inside your head","width":1280},{"text":"exec says hey forget that program, do this other thing instead","width":128},{"text":"it's a complete mind wipe of your process","width":320},{"text":"whatever it was doing, whatever variables you created, whatever memory allocated, it's gone!","width":384},{"text":"you're saying this process will now actually be executing this other image","width":256},{"text":"right, load this other executable from disk and run that instead","width":320},{"text":"so we will run this right","width":832},{"text":"alright so when I run my program now, it actually runs ls","width":1088},{"text":"it actually gives me the contents of the current directory which is just a dot","width":320},{"text":"now here's something weird, I can understand that the last argument here might be null to mean \"hey i've got no more things I want to talk about here\"","width":576},{"text":"but why is it that I've got /bin/ls twice?","width":256},{"text":"okay, here's why: the first one is the command that you actually want to execute","width":896},{"text":"so inside /bin there is a whole load of commands","width":192},{"text":"here I think we've looked at them before","width":384},{"text":"but remember, when you run a command, you want to give it arguments","width":448},{"text":"so when I call say ls, so here it is exactly, I need to say okay what do I want to do?","width":512},{"text":"well I want to look inside /usr/include","width":192},{"text":"but that's not what the program sees","width":128},{"text":"the program sees the arguments you provide also its own name","width":192},{"text":"the name that it's running as","width":192},{"text":"so that's why you see the exec/ls twice","width":320},{"text":"because this is the program that we want to run and this is the argument zero that it will get inside main","width":448},{"text":"so we could probably change this to just say ls for example","width":256},{"text":"okay so that'e exec, notice that my program never printed hello world","width":384},{"text":"that's right, it had a mind wipe","width":128},{"text":"if exec works, we never return, we don't execute anymore code here","width":384},{"text":"so the only way to say print out hello world is to make it deliberately fail","width":320},{"text":"I'm pretty confident that that program, that image does not exist","width":256},{"text":"so exec will fail, it will return -1 and now it prints hello world","width":320},{"text":"it continued on and in fact we can actually print something useful by using perror","width":384},{"text":"my exec failed and we used perror","width":512},{"text":"it prints out your string a colon and a little message here","width":320},{"text":"so here we go, my exec failed: no such file or directory","width":256},{"text":"doesn't tell you which line it failed on but at least you have a hint as to the kind of error that happened","width":448}]