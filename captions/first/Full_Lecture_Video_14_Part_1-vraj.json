[{"text":"so did anyone come up with a way to not deadlock our writers without telling me the code what would your pproach be to not let the writers deadlock?","width":832},{"text":"so to broadcast to the writers first then the readers","width":512},{"text":"im not sure that would entirely fix the problem because even if i broadcast the writers","width":320},{"text":"wait let's go back to this code for a second","width":192},{"text":"even if i broadcast here to the writers","width":256},{"text":"the writer wil wake up but there's still readers inside and it'll still block","width":192},{"text":"so it's a good try ","width":128},{"text":"so it's the right approach you have to do somehting that gives preference to the writers","width":384},{"text":"that's how we're gonna fix this","width":128},{"text":"so one thing you can do is put a number of make sure no one reads forever","width":1344},{"text":"so the solution i have is not gonna break the problem of someone reading forever","width":320},{"text":"if somebody reads forever i;m never gonna let a writer in","width":320},{"text":"so ummm ","width":64},{"text":"that is a limitation of the solution i'm gonna show you","width":256},{"text":"even if you just let even if you say that your reader can be in there for 10 seconds","width":320},{"text":"let's do it that way","width":128},{"text":"instead of giving it a time limit","width":128},{"text":"you can still have every second a reader comes along","width":256},{"text":"so probably we should put a limit on the solution i;m gonna show you","width":320},{"text":"to make sure that the readr's not gonna stay in forever","width":128},{"text":"it would be really good if we could have them enter in the order in which they receive","width":960},{"text":"did anybody come up with a solution kinda like that?","width":64},{"text":"that's pretty close to what i;m gonna do","width":576},{"text":"so basically what i'm gonna show you is a way to say ok","width":128},{"text":"i have a waiting flag","width":128},{"text":"for writers coming in and writer's waiting i'm gonna send a waiting flag","width":256},{"text":"and if there's a writer waiting","width":128},{"text":"i'm not gonna let anymore readers in","width":128},{"text":"and whatever reader are in i'm gonna drop through","width":192},{"text":"and those readers once they're done ","width":128},{"text":"the writers next","width":128},{"text":"and i'll show you how that works","width":128},{"text":"you know what i have the code here not gonna write the whole thing down","width":512},{"text":"we can look over it","width":320},{"text":"ok so here's my reader and my writer","width":64},{"text":"so i've added ","width":256},{"text":"here","width":128},{"text":"i now have 2 ","width":128},{"text":"counting semaphor","width":128},{"text":"2 counters","width":64},{"text":"that have to do with readers instead of just 1","width":320},{"text":"that i have a want to enter the critical section","width":320},{"text":"and this one says","width":448},{"text":"writers writing","width":192},{"text":"what value can this one have","width":512},{"text":"what value can the writers waiting hve","width":512},{"text":"okay what value can this one have","width":320},{"text":"the writers writing","width":64},{"text":"jsut one","width":128},{"text":"how about this one here","width":64},{"text":"no","width":128},{"text":"i can have lots of writers writing","width":192},{"text":"it just tells me that there are writers waiting","width":192},{"text":"okay and as long as there's waiting","width":128},{"text":"this one says as long as there's writers waiting in stead of writers writing","width":448},{"text":"i'm gonna block my readers","width":128},{"text":"and","width":64},{"text":"this part","width":64},{"text":"right here","width":192},{"text":"says that as lng as there's a writer writing","width":192},{"text":"i'm not gonna drop out of my condtion wait while loop","width":256},{"text":"okay","width":64},{"text":"so what's gonna happen is 1 writer's gonna come along","width":192},{"text":"it's going to ","width":192},{"text":"say that somebody's reading say we have 1 reader  in there","width":256},{"text":"let's let the reader go first","width":64},{"text":"reader comes in ","width":64},{"text":"i need my variables set here","width":320},{"text":"so we have","width":128},{"text":"writers ","width":128},{"text":"writing","width":128},{"text":"and","width":64},{"text":"reading","width":64},{"text":"and they all start off as","width":384},{"text":"0","width":64},{"text":"so i have a reader that comes along","width":320},{"text":"it's gonna come along here and check to see if there's writers it's gonna say no no writers","width":256},{"text":"so ","width":64},{"text":"uhh","width":128},{"text":"it's gonna fall through the condition variable i don't have to wait and then it's gonna increment writing, reading i'm sorry","width":320},{"text":"it's gonna stay in reading here for a second","width":256},{"text":"let's leave it there for aminute","width":64},{"text":"to make sure that the writers are gonna be able to get through","width":192},{"text":"so now i have a writer its gonna incrmeent it's gonna acquire the lock so it can change the writers value ok so now i have one writer waiting","width":576},{"text":"but now i need to check somebody's reading am i gonna fall out of this loop?","width":448},{"text":"yes or no","width":64},{"text":"can i pass this line?","width":384},{"text":"alright i'm gonna do while reading or writing am i reading or writing?","width":512},{"text":"yes","width":64},{"text":"so i do my condition wait","width":128},{"text":"so now my first writer is blocked here","width":128},{"text":"and","width":192},{"text":"what happens when it calls the condition variable?","width":192},{"text":"it releases the lock","width":128},{"text":"so","width":128},{"text":"and now i have another writer come along","width":192},{"text":"same thing happens i'm gonna increment my writers to 2","width":192},{"text":"and my second one ","width":192},{"text":"is gonna block right there","width":64},{"text":"is tht clear?","width":128},{"text":"yea?","width":64},{"text":"nothing's happened yet right we haven't been signaled yet so now","width":832},{"text":"let's go back to this reader","width":128},{"text":"so this reader's done","width":128},{"text":"it gets the lock it decrements reading now to 0","width":448},{"text":"and","width":64},{"text":"it signals everyobdy","width":128},{"text":"that will wake up it's doing a signal broadcast","width":256},{"text":"it will wake up both of the writers","width":128},{"text":"both of the writers will acquire the lock 1 at a time","width":320},{"text":"right they're not gonna do it at the same time","width":64},{"text":"the first one that acquires the lock will say ","width":256},{"text":"is reading 0?","width":64},{"text":"yes","width":64},{"text":"is writing 0?","width":128},{"text":"yes","width":64},{"text":"so","width":64},{"text":"that one can fall throgh","width":128},{"text":"and","width":64},{"text":"it can now","width":64},{"text":"set writing to 1","width":192},{"text":"and there's somebody writing","width":192},{"text":"ok","width":128},{"text":"so now","width":64},{"text":"if you look at another reader coming along","width":192},{"text":"it's gonna say is there are there writers waiting?","width":384},{"text":"yes","width":64},{"text":"ok now wait","width":64},{"text":"what did i just trade off","width":448},{"text":"this is not a perfect solution either","width":256},{"text":"yeah?","width":64},{"text":"there's no better way for the readers so i now put the priority on the writers instead of on the readrs","width":576},{"text":"there are solutons","width":192},{"text":"or","width":128},{"text":"for having counters and allowing them to go in step by step i don't think lawrence was having you going through the priority solutions so this is the one he wanted me to go through with you","width":768}]