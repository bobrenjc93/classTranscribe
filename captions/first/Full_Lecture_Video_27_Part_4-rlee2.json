[{"text":"and im now forever cursed by looking at that and thinking that way so i'm happy today to share this curse","width":100},{"text":" so this tilde means also home directory","width":100},{"text":" it won't inside of c programs","width":100},{"text":" its just a function of the shell program","width":100},{"text":" such as bash","width":100},{"text":" so if you are somewhere else and you quickly want to refer to a file inside the home directory you can do [symbol tilde]/hello and my favorite little trick is cd - which means go back to the previous directory that I was in","width":100},{"text":" so if i wanted to swap quicky between two directories I could do cd -","width":100},{"text":" and finally theres push directory and pop directory","width":100},{"text":" which allows me to say remember the current directory im in and later go back to it","width":100},{"text":" so theres just some little kind of unix helpful things to do","width":100},{"text":" with that lets have a look at page 2","width":100},{"text":" so here is how we can lay out the information we want to store inside our secondary storage","width":100},{"text":" well have our meta information stored inside these inodes and we'll just put all of the inodes together","width":100},{"text":" we'll talk more about that term next week","width":100},{"text":" so now we've got some remaining space","width":100},{"text":" so when we first format this disk","width":100},{"text":" were actually going to say we assume I have never need any more","width":100},{"text":" we have a maximum number of inodes so we just have a fixed size table here","width":100},{"text":" and we have the bulk of the remaining space","width":100},{"text":" and we split this up into the disk blocks","width":100},{"text":" and then later when I want to get my data","width":100},{"text":" I will actually say ok give me disk block 0 give me disk block 1 etc","width":100},{"text":" ","width":100},{"text":"and so on","width":128},{"text":"so today. what we're going to do is look at how we can actually store the contents of a file using this classic inode structure.","width":1152},{"text":"here's the game","width":384},{"text":"we want to be able to store very small files efficiently and be able to access them very quickly","width":512},{"text":"disk access is slow on a spinning disk","width":128},{"text":"on a spinning disk we have to wait a long time for the disk head to move to the right head and for the disk to spin around before you can get um the data","width":512},{"text":"its actually an easy calculation if you know the disk rotation speed like 5500 rpm or 7000 rpm you can figure out how many miliseconds before it's done one revolution and moved to the right spot","width":832},{"text":"but its the order of 10s of miliseconds","width":192},{"text":"so","width":64},{"text":"we want to do minimizing of disk accesses for small files.","width":384},{"text":"so what we want to do for very small files is inside the inode we'll just store the disk block numbers","width":384},{"text":"for some direct blocks right","width":256},{"text":"so the beginning of our file will be inside block 7 or block 8 ","width":320},{"text":"uh block 9 is actually already being used so we want to go to block 22 and so on and so on and so on","width":320},{"text":"so if i want to read a file ","width":384},{"text":"I'm going to have to read the inode","width":192},{"text":"which I might already have inside memory","width":128},{"text":"and we're going directly to these block sand request","width":256},{"text":"the trouble is our inodes are of fixed size","width":320},{"text":"we just put them all together in this little array here","width":192},{"text":"so our scheme is only going to work for a small number of direct blocks.","width":320},{"text":"and typically this number is about 10","width":128},{"text":"so we have 10 of these","width":128},{"text":"the advantage of course ","width":192},{"text":"is that the small files","width":128},{"text":"its very very quick to know which disk blocks I need","width":256},{"text":"here's what happens next","width":64},{"text":"wwell take one of our standard regular blocks","width":256},{"text":"and we'll use it not to store any data in","width":192},{"text":"but just to store ","width":192},{"text":"some numbers","width":64},{"text":"the numbers of where to go next","width":256},{"text":"so","width":64},{"text":"go to block # 4","width":192},{"text":"go to block #199","width":64},{"text":"go to block # 233","width":256},{"text":"etc etc","width":64},{"text":"etc","width":64},{"text":"so we better figure out","width":384},{"text":"how many entries we can put inside one of these disk blocks","width":320},{"text":"so","width":128},{"text":"also two pieces of information we need here","width":128},{"text":"size of our disk block and size of each pointer","width":384},{"text":"ok","width":192},{"text":"so lets write one out","width":128},{"text":"lets suppose our disk is using 64bit addressing","width":256},{"text":"so we can have alot of disk blocks","width":192},{"text":"how many bytes is this","width":192},{"text":"8","width":192},{"text":"also known as 2^3","width":192},{"text":"and lets say","width":320},{"text":"that each block is ","width":64},{"text":"4kb","width":64},{"text":"whats that in 2^n notation?","width":384},{"text":"uhh ok","width":192},{"text":"well","width":64},{"text":"everyone knows that 2^8 is 256","width":128},{"text":"2^10 is 2014","width":256},{"text":"so 4k is 4 times that so its 2^12","width":384},{"text":"so if you have got 2^12 bytes and each entry takes 2^3 bytes","width":448},{"text":"my back of the envelope calculation tells me ","width":256},{"text":"that 2^12/ 2^3 = 2^9","width":512},{"text":"oops there we go","width":64},{"text":"I can store 2^9 entries","width":192},{"text":"ok whats what. what number is 2^9","width":512},{"text":"512!","width":320},{"text":"so I can have 512 of these blocks","width":320},{"text":" so if that was the end of our addressing scheme. we can actually work out whats the largest file that we could store","width":896},{"text":"right so forget this stuff for a moment","width":128},{"text":"how big of a file could we have","width":128},{"text":"well we have 512 data blocks here + another 10 here","width":192},{"text":"so if that was everything I could have 522 times each block was 4kb","width":576},{"text":"and that would tell me then","width":192},{"text":"how much space my largest file could be","width":192},{"text":"so what do we do when our file is bigger than that?","width":256},{"text":"ok","width":64},{"text":"so the famous quote by wheeler","width":192},{"text":"every problem in computer science can be solved by another level of indirection","width":256},{"text":"so if you've got a problem dont worry just wrap it around","width":256},{"text":"well fix it by encasing the problem with ","width":256},{"text":"with another solution","width":64},{"text":"this was done on the DCL building","width":192},{"text":"have you ever walked through the dcl and notice there are outside windows on the inside","width":320},{"text":"thats because we have glued the building","width":128},{"text":"and rather than building a new building we just put the building inside a bigger building","width":320},{"text":"so next time you walk through dcl you'll notice ahh thats why there are window panes there","width":320},{"text":"so ","width":64},{"text":"heres our plan then","width":128},{"text":"if that for even bigger files well have a lookup table of lookup tables","width":320},{"text":"wait a moment","width":64},{"text":"this was just like like virtual memory yes?","width":256},{"text":"we had a multi level table","width":128},{"text":"and the key thing here is that for medium files more of these need to exist","width":448},{"text":"we can grow this as needed","width":64}]
