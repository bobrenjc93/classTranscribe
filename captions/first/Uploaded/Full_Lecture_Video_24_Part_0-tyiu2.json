[{"text":"alright good afternoon class","width":192},{"text":"now so today we have quite a few pretentives in the orders","width":320},{"text":"if you traveled here because you ... cs 241 but ur just visiting the class today","width":448},{"text":"please waave your hand","width":128},{"text":"i know theres quite a few of you","width":256},{"text":"right","width":64},{"text":"these people advisors just been accpeted to cs major program","width":320},{"text":"visiting campus","width":192},{"text":"so be sure to be nice to them and tell them","width":192},{"text":"what a great place wisconsin is","width":192},{"text":"so here's what we are going to do today","width":256},{"text":"so here's what we are going to be today","width":64},{"text":"we can finish our discussion about sockets","width":128},{"text":"uhh in terms of .. what we can do is we use imports, and ","width":384},{"text":"what happens if","width":64},{"text":"is my mic on yet","width":128},{"text":"what happens if we dont set various socket options when we are developing our programs","width":320},{"text":"and we discover that the port is in use","width":128},{"text":"and that kind of stuff","width":64},{"text":"and then we talk about how can we make the server as you discover who is connected to us so we can find out for example","width":576},{"text":"its ip address","width":192},{"text":"so yesterday you may yik yak, or at least use a very simple version of yik yak, where we connect to our virtual machines","width":512},{"text":"on the android tablet","width":64},{"text":"and now that we want to make it so that our server can actually find out who connected it","width":320},{"text":"a little story for you","width":128},{"text":"that is the very first time i visited urbana champaign","width":128},{"text":"was I was visiting wolfram research","width":192},{"text":"just down the road, you may have heard of them","width":64},{"text":"they made methametica","width":128},{"text":"i did some 3d visualization software which connected to wolfram using sockets","width":448},{"text":"they connected to mathematica using sockets","width":128},{"text":"and this is back in the day when we actually made a plugin ","width":320},{"text":"an external piece of software","width":64},{"text":"to display 3 dimensional shapes","width":192},{"text":"so i was talking to them","width":64},{"text":"and back in the older days of the web, before blogs","width":512},{"text":"and they said, you know, one trick what we do, about our web server, is we got various competitors right now","width":192},{"text":"and we dont want them to know immediately when we release our product","width":448},{"text":"so when they come to our website, we check their ip address of the connection and we serve them the old content","width":192},{"text":"so our competitors see our content at least two days old","width":448},{"text":"so they'll be a bit slow in discovering when we actually release new software","width":256},{"text":"so that's something you can play with","width":64},{"text":"with the yik yak implementation ","width":320},{"text":"that give bad inforamtion","width":128},{"text":"if you don't like the client connecting to your server","width":64},{"text":"hey, give them something, give them some alternative information","width":320},{"text":"ok","width":192},{"text":"so","width":64},{"text":"how can you do that? easy!","width":64},{"text":"look at, say, the ip address, the bytes they sending to you","width":320},{"text":"you could invent a new protocal","width":64},{"text":"all messages to you should have a hash value","width":192},{"text":"which store what [gibberish] etc. etc. etc","width":192},{"text":"and why not share your protocal with your friends at cs 241","width":320},{"text":"so that you can connect to each others' virtual machines","width":256},{"text":"and why not tell some bad information to the people you dont like in cs 241","width":192},{"text":"and then you can tell them when the exam's on when they re not","width":256},{"text":"alright ","width":192},{"text":"so","width":64},{"text":"lets go out for our handout for today","width":64},{"text":"uhh we need","width":128},{"text":"i can ... some content today","width":192},{"text":"alright what's the honey pot","width":64},{"text":"easy! a place for honey! remember this?","width":256},{"text":"we can make servers that ... as real machines ","width":256},{"text":"and then uhh see how they","width":448},{"text":"'ve been used on internet","width":64},{"text":"for example, what you see in todays lecture","width":192},{"text":"is how can we discover what client is connecting to our server","width":256},{"text":"so we can label those ip addresses","width":128},{"text":"you could for example on your virtual machine","width":128},{"text":"have a port 80 open up ","width":192},{"text":"and see if anybody tries to connect to your machine","width":192},{"text":"okay so","width":192},{"text":"what are the purpose of these clause","width":256},{"text":"[gibberish] what do they do","width":256},{"text":"yes host to network and network to host","width":384},{"text":"why do we need this","width":64},{"text":"well because if we gonna be transfer bytes to each other we should agree on what order we should send the bytes","width":448},{"text":"for example if we are talking about an integer of two bytes long, we are sending the low byte or the high byte first","width":320},{"text":"and our cpu may not respect that perticular ordering","width":256},{"text":"and in fact if you on a intel machine it is actually the wrong order","width":320},{"text":"ok so we can use these to make sure that any integer values we send as binary are correctly ordered, that we put them in the right order","width":704},{"text":"for either working in our cpu or sending out on the wire we send it to the network card","width":320},{"text":"ok so its time for host to network short, network to host, short","width":320},{"text":"so we'd use this, for example, when working with port numbers","width":192},{"text":"umm port numbers are 16 bits","width":128},{"text":"ok so what are the four calls with the network server","width":128},{"text":"we've done this already arent wee","width":128},{"text":"remember","width":64},{"text":"our basic idea is we want to make a socket","width":320},{"text":"we'll say what kind of socket","width":64},{"text":"right","width":64},{"text":"then well call bind","width":256},{"text":"because we want to bind to a particular local port","width":192},{"text":"we may also use it to bind to a particular network card","width":384},{"text":"so weve made actual socket now so how do we get started","width":256},{"text":"we call listen","width":64},{"text":"all of these things will happen very quickly","width":192},{"text":"the next one will block, and that is when we call accept","width":384},{"text":"acccept now will block if there is no one trying to connect to our server. ","width":256},{"text":"so it only returns when a client has acutally connected. ","width":320},{"text":"why do we call listen?","width":64},{"text":"because we may want to set up a small","width":192},{"text":"queue so that if multiple clients connects together, the operating system is prepared to look after those immediate connections until we get them from accept","width":832},{"text":"and each time you accept, you get a new file descriptor","width":128},{"text":"and each time the client connects, it gets a new port to talk to","width":320},{"text":"alright so we've seen that","width":64},{"text":"now","width":64},{"text":"one thing i didnt talk about before","width":64},{"text":"was","width":192},{"text":"freeaddrinfo","width":192},{"text":"yes we've been playing with getaddrinfo","width":128},{"text":"to fill in a pointer to that struct ","width":384},{"text":"and remember that struct actually could be a linked list","width":256},{"text":"so when we finished using it","width":192},{"text":"rather than having to walk through the linked list ourselves","width":192},{"text":"there happens to be something called freeaddrinfo that does this for us","width":192},{"text":"and of course that is going to pull out the next pointer before calling free on each struct","width":448},{"text":"so what do you think might be wrong with this little piece of code here","width":256},{"text":"you can assume that inside the dot dot dot i've called memset on hints and i set up the hints struct correctly ","width":512},{"text":"umm but what do you think mistake i might have made in writing this little bit of code","width":384},{"text":"make a pointer, called getaddrinfo, and then I called this function called free to say ","width":576},{"text":"ok, free that linkedlist that getaddrinfo set up for me","width":256},{"text":"what could possibly go wrong","width":128},{"text":"yes","width":256},{"text":"oh should i pass the address","width":256},{"text":"actually no freeaddrinfo takes a pointer to the first struct and go through destructively and frees up each member of the list ","width":576},{"text":"okay time to put ur, yes","width":128},{"text":"thank you","width":256},{"text":"yes","width":64},{"text":"right","width":64},{"text":"so, remember we need to ask ourselves what could possibly go wrong","width":320},{"text":"ok here's one possibility ","width":128},{"text":"suppose getaddrinfo failed","width":128},{"text":"for example, you haven't actually connected to the wifi so it cant do the domain name lookup and find ip address","width":640},{"text":"so suppose getaddrinfo fails","width":256},{"text":"that means it never changed this pointer","width":128},{"text":"","width":64}]