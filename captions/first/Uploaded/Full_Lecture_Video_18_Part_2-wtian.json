[{"text":"So we have a problem","width":256},{"text":"we have invented virtual memory, but we have halved the running speed of our machine","width":384},{"text":"this might be a difficult thing to sell in the marketplace if we half the speed","width":320},{"text":"so we need to do something about this","width":256},{"text":"okay we can have caches, etc but we still got the problem","width":256},{"text":"Now, we've invented virtual memory which is great, we don't have to worry have fragmentation so much","width":448},{"text":"but we halved the speed","width":384},{"text":"we halved the speed because we're doing this lookup","width":192},{"text":"lets see what happens when we use a two level page design","width":320},{"text":"so why might be care about two level page design","width":512},{"text":"well lets do a similar calculation but for a 64 bit system","width":384},{"text":"lets keep our page sizes at 4096 bytes","width":320},{"text":"so, what is this? this is 12 bits... so if thats my offset. how many bits do i have for my page number?","width":1216},{"text":"64 - 12. i got 52 bits","width":704},{"text":"thats gonna be used for my lookup table","width":448},{"text":"so how big is my lookup table gonna be","width":448},{"text":"2^52","width":128},{"text":"how big is 2^52","width":192},{"text":"okay so how do we work this out roughly. well 2^10 is a 1000.","width":640},{"text":"so","width":128},{"text":"okay its a little big","width":704},{"text":"this is the number of entries i'll need inside my page table","width":256},{"text":"i better go home and and buy a lot of memory just to store my page table","width":320},{"text":"so what worked really well in 32 bits is completely falls over in 64 bit land","width":512},{"text":"because, we... heh. our page table is just too large!","width":384},{"text":"BUT","width":192},{"text":"to quote black adam","width":128},{"text":"\"we have a cunning plan.. we'll have a cunning plan\"","width":128},{"text":"We will use a multilevel page table","width":256},{"text":"because, our address space is huge, but guess what: most of it is unused!","width":576},{"text":"so, let's split this 52 bits up into multiple lookups","width":768},{"text":"so we'll take this and split it up into pieces","width":576},{"text":"lets start it with just two. so the idea is:","width":768},{"text":"I've got an initial lookup here","width":192},{"text":"lets say that its, that we use um... iuno.. 10 bits","width":640},{"text":"sometimes they only uses 4, but this is matter of example","width":192},{"text":"so we use the upper most 10 bits","width":384},{"text":"some of these can be empty, they may not refer to anything. they may not be used in that huge swath of address space","width":448},{"text":"we dont even need an entry in here","width":128},{"text":"so lets say that the lowest and highest entries are used here","width":448},{"text":"so this will point to another page table ","width":128},{"text":"with a whole lot of entries, lets say in this one, we have twelve bits","width":512},{"text":"and these entries may or may not be filled, but they dont refer to frame numbers yet. i can keep playing this game for as long as i want","width":832},{"text":"until i got up to a total of 52 bits","width":192},{"text":"so how many bits have i used up so far... twenty twentytwo.... ","width":512},{"text":"so now ive got","width":64},{"text":"thirty bits, for example in my last one:","width":320},{"text":"and son","width":64},{"text":"so ive just invented a little page table system here, a multilevel page system, where","width":640},{"text":"to convert the page number to a frame number, i now have to do one two THREE memory reads","width":640},{"text":"and each of these can point to a different table","width":576},{"text":"right so this one will point to a different area of memory... just say oky","width":256},{"text":"these are the entries in here, they may or may not be filled","width":320},{"text":"and","width":64},{"text":"so on","width":128},{"text":"so now i've made my 64 bit machine even slower than my 32 bit machine","width":448},{"text":"now a single read or single write now takes 4 memory looks up","width":512},{"text":"the actual read itself and all these page table looks up","width":128},{"text":"if I was working at Intel at this point, I think i'd be fired","width":256},{"text":"we've come up with a machine that is now twice as fast as last years model","width":448},{"text":"but dont worry its got a bigger number on the box, so people are gonna buy it","width":192},{"text":"right","width":128},{"text":"so this is the idea: so we've got a basic idea of how to split this up with the idea that we can do multiple table looks up","width":768},{"text":"we have just got a little bit of a problem that most of the time, its incredibly slow","width":320},{"text":"so in a little bit, we'll talk about how to fix that","width":192},{"text":"alright so lets do this","width":256},{"text":"we'll work this out on a 32 bit system","width":256},{"text":"and for a two level page table example, we'll say we'll have 10 bits","width":640},{"text":"i wanna get it up to 32","width":192},{"text":"and then uh","width":64},{"text":"12 bits for upset","width":256},{"text":"so how many memory reads are require to read a byte at this address","width":448},{"text":"well you wanna do a read first of all, you go to top level page table.","width":320},{"text":"this gives you the address of the next page table and finally this gives you the frame number","width":576},{"text":"for memories","width":320},{"text":"so in a two level page table, we are running at three memory reads for every actual read or write that you wanna do","width":640},{"text":"sorry. three memory accesses that your program tries to do.","width":320},{"text":"so we're three times as slow","width":192},{"text":"so this is a great system that allows us to have virtual memory, but as i keep saying: ITS SLOW","width":704},{"text":"so whats the fix?","width":64},{"text":"the fix is this...","width":128},{"text":"translation lookaside buffer","width":192}]