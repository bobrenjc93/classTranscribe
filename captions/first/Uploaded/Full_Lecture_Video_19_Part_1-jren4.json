[{"text":"Okay, so other thing to do then is to be the child","width":100},{"text":" As a child, you want to write from this","width":100},{"text":" Okay, so how can we do this? Well one low level way of doing without the c-library is to do directly call read, and if you call read, you need say which file descriptor and so, that would be fds 0","width":100},{"text":" And you need to say, Hey here I got some buffer, I got some memory you can use, and also say how many bytes I am prepared to accept","width":100},{"text":" so if I was to make, for example, a little space on my stack here","width":100},{"text":" I could then say read into the buffer, and here is the size of my array","width":100},{"text":" ","width":100},{"text":"Now if you call read like this, of course you may not get a thousand twenty four bytes","width":100},{"text":" So actually we should see how many bytes we got","width":100},{"text":" Here is the number of bytes and we expect that to be greater than zero","width":100},{"text":" In fact, read will block until we get some bytes out of that pipe","width":100},{"text":" Okay, what should we do with this bytes","width":100},{"text":" Well, let's for now print out \"Hurrag I can't some bytes\"","width":100},{"text":" say the number, and we could say, read what happens","width":100},{"text":" Right, and you can perhaps guess what might happen here","width":100},{"text":" So we want to say we got this number of bytes and here is the buffer","width":100},{"text":" Okay, and I'll do a new line, so we flush this","width":100},{"text":" Great, so let's try this and see what we get","width":100},{"text":"","width":100},{"text":"Alright, so parent sent some bytes, and \"Hurrag I cant some bytes","width":100},{"text":"\" Right, so my typo is there","width":100},{"text":" So we saw six bytes, and we saw \"Hello","width":100},{"text":"\" Now, one two three four five","width":100},{"text":" We were lucky in this case","width":100},{"text":" Why were we lucky? Yes! correct, we didn't send the null byte","width":100},{"text":" We sent \"Hello\" and then new line, which happen to be six bytes","width":100},{"text":" Well we never actually sent a null byte","width":100},{"text":" We chose to not send a null byte","width":100},{"text":" We just sent it as bytes","width":100},{"text":" And the operating system doesn't care","width":100},{"text":" It just says \"Okay we got some bytes from my parent","width":100},{"text":"\" We got some bytes from pipes that stick them down, and later it says \"Okay we'll read this many bytes","width":100},{"text":"\" So, outcome is actually dangerous","width":100},{"text":" The code could have printed out gibberish after the \"Hello","width":100},{"text":"\" ","width":100},{"text":"Let's fill up our buffer with some garbage, right","width":100},{"text":" Let's put an extra character in there","width":100},{"text":" And you'll see that we manage to print out the hash as well","width":100},{"text":" Because it's not a part of the message","width":100},{"text":" So the mistake is that we forget that the string has a null byte, and if you want to do string processing on the byte that you get back, remember to include the null byte","width":100},{"text":" Either send it explicitly down your pipe or add it afterwards","width":100},{"text":"","width":100},{"text":"The operating system doesn't know that you're sending a string data","width":100},{"text":" It's just bytes as the operating system concerned","width":100},{"text":" It's just \"Hey, I'm gonna put this on the memory","width":100},{"text":" Here's some bytes to send the pipe","width":100},{"text":"\" So, what could we do with this","width":100},{"text":" One common thing to do is to include special character in the end of our message","width":100},{"text":" Maybe a null byte, for example","width":100},{"text":" Or another character to say \"Okay, I'm not going to send anymore data\" So, if I for example, I could say I know that my normal data would never use an exclamation point","width":100},{"text":" So that my reader would say, \"Oh look, I just saw an exclamation point","width":100},{"text":"\" I now know that was the special terminator to say that \"okay my parent is done with me, and it's never gonna send any more data","width":100},{"text":"\" So telling the reader that you have no more data is easy","width":100},{"text":" You could just simply include a character","width":100},{"text":"","width":100},{"text":"Okay, so telling the reader, you just send something special You send \"Okay, good bye\", and then you write a little bit of code and say, \"Oh look, I've just got the final piece of information","width":100},{"text":" Now I know there is no more data coming","width":100},{"text":"\"","width":100},{"text":"There is another problem, which is \"What if the reader closes and the writer doesn't know","width":100},{"text":"\" And we will return to that in the second half of the lecture, so this just a quick introduction to pipes","width":100},{"text":" Look they are pretty easy and now they can give you a form of inter-process communication","width":100},{"text":" If you want your child and your parent to send stuff to each other, guess what? You need two pipes","width":100},{"text":"","width":100},{"text":"And, I deliberately didn't tell you one more detail, which we will review in a little bit","width":100},{"text":" About closing these file descriptors","width":100},{"text":" This is kind of naive version of pipes","width":100},{"text":" We'll come back just in a little bit","width":100},{"text":" Instead, we'll gonna talk about fseek and ftell","width":100},{"text":" Unless any has any quick question","width":100},{"text":"","width":100},{"text":"No quick question","width":100},{"text":" So the comment here is \"Whoops, we should be closing stuff","width":100},{"text":"\" And we should be closing stuff here too","width":100},{"text":" Okay","width":100},{"text":" Alright, so let's do fseek and ftell","width":100},{"text":" ","width":100},{"text":"Alright, so the next thing we'll talk about is our file descriptor, when it talk to a normal file when we call let's say open or fopen a file","width":100},{"text":" Have a position","width":100},{"text":" Right? We can say \"Okay give me the next line","width":100},{"text":"\" Say call read line","width":100},{"text":" Or read the following next 8 bytes","width":100},{"text":" On every time we talk to a file descriptor then, we're changing the position in a file","width":100},{"text":" So operating system is keeping track of that","width":100},{"text":" We can change it","width":100},{"text":" One other cool thing we can actually do is jump to the very end of the file","width":100},{"text":"","width":100},{"text":"So, why might that be useful? Okay, we want to write some data again","width":100},{"text":" Suppose you want to know how big your file was is the plan","width":100},{"text":" Move the file descriptor, so it's right at the end of the file, and then say \"Excuse, what position am I?\" And that tell's you how big the file is","width":100},{"text":" So please tell me my current position","width":100}]
