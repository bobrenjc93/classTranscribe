[{"text":"alright and keep doing this while either one of these is valid","width":640},{"text":"okay what do you think about that code?","width":192},{"text":"hold on hold on you can't see it","width":320},{"text":"is this code correct?","width":128},{"text":"does it copy the null byte at the end?","width":1024},{"text":"okay alright if your neighbor thinks it copies the null byte get a new neighbor","width":640},{"text":"right why does it not copy the null byte?","width":128},{"text":"because we've incremented the source pointer","width":576},{"text":"right so we copy a byte, we keep copying characters and then we increment the source pointer and then we say while source","width":576},{"text":"so we are checking the next byte, the byte that we haven't yet copied","width":320},{"text":"so no, that code doesn't actually coy the very last byte","width":384},{"text":"you see, C program is easy","width":128},{"text":"or actually C programming with bugs is easy, writing correct programs is harder","width":512},{"text":"and we wouldn't have spotted this if our destination memory had all been zeroed by some fortuitous accident","width":512},{"text":"so that is incomplete, we still need to copy the byte at the end","width":320},{"text":"so at the very end I need to put a null byte in","width":256},{"text":"so I could write that as zero, I could write that as backslash zero","width":448},{"text":"that means the null byte","width":192},{"text":"and then finally return dest","width":576},{"text":"okay what do you think about that code","width":128},{"text":"yes, so if source is just an empty string what would happen?","width":768},{"text":"correct, we put two null bytes at the end","width":320},{"text":"so that's dangerous right? our code would actually copy more bytes than say the standard specification","width":512},{"text":"so now we've got a bug that only happens when we copy empty strings","width":512},{"text":"what else? there's another bug as well. yes? I'm writing memory that isn't part of dest or source","width":896},{"text":"okay, so I haven't malloc'd a new buffer yeah. okay so let me first mention the error I was going to point out","width":512},{"text":"which is actually the specification of strcat says we should return the beginning of the string","width":192},{"text":"we are actually returning the end of the string","width":128},{"text":"whoops, so we probably should have kept a copy of what the original value of dest was","width":384},{"text":"as it happens, most people don't tend to use this return value","width":256},{"text":"and so your code might work in most places until the day it doesn't","width":256},{"text":"now let's get back to that question of oh we haven't malloc'd any memory","width":384},{"text":"so strcat actually assumes that the destination is big enough for all these bytes that we are going to copy","width":448},{"text":"it doesn't do any mallocing itself, it just says okay give me a pointer, I'm going to assume that there is enough bytes available for me to copy whatever is available at source","width":704},{"text":"and if that is not true, well let's hope this code isn't actually driving a car or an expensive robot or flying a plane","width":512},{"text":"or something inside your bloodstream","width":256},{"text":"so strcat is dangerous, you have to promise that you've got enough bytes allocated at the target","width":704},{"text":"and for that reason many people avoid it and use strncat instead","width":320},{"text":"which I'm not going to talk about today","width":192},{"text":"and that saves you from some of these gotchas","width":256},{"text":"so it's better but it's still not perfect","width":192},{"text":"you can still have problems with strncat but I don't have time to talk about it right now","width":448},{"text":"okay right so for your next serving of C, I've got some code down here that uses strcpy and strcat and arrays and pointers to stuff","width":704},{"text":"what errors do you spot? if this was say a code review or in an interview and they said \"hey look at this code, what can you tell me about this?\"","width":576},{"text":"what can you and your neighbor find? what errors?","width":320},{"text":"what kinds of errors and how would you explain them?","width":256},{"text":"[long pause]","width":9792}]