[{"text":"so this getaddrinfo() is ","width":1344},{"text":"sort of a powerhouse of a call","width":128},{"text":"it does an awful lot of work behind the scenes","width":128},{"text":"including making a network connection, say \"hey! hey, anybody! anybody know who this is? www.illinois.edu? anybody got an ip address to this?\"","width":832},{"text":"so what am i talking about? i'm talking about","width":256},{"text":"dns, and we'll talk more about dns a different time","width":192},{"text":"well that itself, but that call itself could be making network requests to say \"hey i need the ip address that's connected to this name\"","width":576},{"text":"so the whole lot of stuff that happens behind the scenes just to discover the ip address","width":512},{"text":"right, so what does the ip address go into? it goes into one of these structs","width":320},{"text":"and where does the ip address actually appear?","width":384},{"text":"it actually appears inside here, this little [gibberish] here, this address, and this server thing called addrlen is set","width":512},{"text":"so why can address be different lengths?","width":192},{"text":"well, socket is an abstract idea, and it might have different kinds of sockets","width":384},{"text":"we might have an ip4 type socket, or we might have an ip6 kind of socket, or we might have an [gibberish] socket","width":448},{"text":"so these c structures are actually designed to be potentially different lengths, so when we call connect, we actually have to say \"and this is actually the size of my data structure\"","width":832},{"text":"right, so","width":512},{"text":"so what have we got? we've got getaddrinfo() to fill out that socket information for me","width":320},{"text":"if we didn't have this, we'd be writing lots more code, and it's really ugly, it's got lots of casts in it","width":320},{"text":"the beautiful thing about this is we set up a hints thing, we say do we want ip4 or ip6, or we don't care, and we say say the socket stream, or we want UDP, and then we create a socket and we can connect to it","width":960},{"text":"and we're done! we're ready for action! right","width":256},{"text":"let's write some code then","width":128},{"text":"so connect will do the handshaking, so now we're going to actually use this thing ","width":576},{"text":"right, so i need to send it something, okay","width":320},{"text":"right, so what i'm going to send?","width":192},{"text":"here can be my request","width":256},{"text":"it'll say \"GET\" homepage","width":384},{"text":"make that larger, here we go","width":64},{"text":"right","width":64},{"text":"get the home page, i'm going to speak http/1.0 to you, and i need to send it these newline characters to say that's the end of my request \"/r/n\", if i wrote it twice","width":960},{"text":"okay, we could ","width":256},{"text":"for debugging let's just print this out","width":128},{"text":"okay","width":384},{"text":"and i'm going to write the minimum code that will kind of work, this is not robust quality code by any means","width":448},{"text":"but we've used a real web server, or any other client","width":256},{"text":"but it's good enough for lecture demo today","width":128},{"text":"right, so","width":64},{"text":"how do we use write()?","width":64},{"text":"well, remember that you need to give it a file descriptor","width":128},{"text":"okay, that's what i got from the socket","width":192},{"text":"you need to give it a pointer to some bytes that we want to send","width":384},{"text":"okay, that was my request","width":192},{"text":"and i need the number of bytes, yes","width":384},{"text":"if","width":256},{"text":"right, the number of bytes","width":192},{"text":"so, could i say request?","width":320},{"text":"how many, what is the size of request?","width":512},{"text":"that's 4 bytes or 8 bytes?","width":256},{"text":"because it's a pointer, it's not within specify as an array","width":256},{"text":"remember arrays, kind of like pointers, but they're not pointers","width":192},{"text":"if you ask for the size of a pointer, you get a size of a pointer, which is 4 bytes on a 32-bit machine, 8 bytes on a 64","width":384},{"text":"we didn't want that","width":128},{"text":"we could've either made request a different type, we could've made it a character array, or we could just calculate it during runtime","width":448},{"text":"so let's do it during runtime","width":64},{"text":"so strlen(), give me the number of characters inside request","width":384},{"text":"i do not need to send the 0 byte","width":256},{"text":"the protocol is not about c-strings, it's the end of the line, the end of the request is to find in terms of these double newline characters, right","width":640},{"text":"so we send that ","width":64},{"text":"i could get the return value to see how many bytes were sent, but nah, it's a lecture","width":320},{"text":"right, so","width":128},{"text":"let's get back to response, okay, we need some space for that, so as this is just a quick demo, we'll just have some space on the stack here","width":704},{"text":"it gives to my response","width":128},{"text":"and ","width":320},{"text":"let's read from that socket","width":384},{"text":"right, sock_fd","width":128},{"text":"i need to give it a pointer to some space, some memory","width":192},{"text":"how many bytes do i want to read up to? we'll say 999","width":256},{"text":"why 999? well, because if len, get at least one thing","width":512},{"text":"we will trigger out as c-strings, so i'm going to terminate it","width":448},{"text":"and finally, we'll print it out","width":448},{"text":"okay","width":512},{"text":"questions at this point?","width":256},{"text":"aha, it's easy! right?","width":448},{"text":"the file descriptor wasn't set once i called connect()","width":384},{"text":"i've connected!","width":128},{"text":"i am network man!","width":64},{"text":"anyway, so we've now got the power of the internet at our fingertips","width":384},{"text":"well at least","width":64},{"text":"all of the internet we can connect to using TCP","width":256},{"text":"right, so let me","width":256},{"text":"[gibberish] okay, we'll do illinois to begin with","width":192},{"text":"right, so","width":64},{"text":"we'll run this ","width":256},{"text":"what'll i call the code?","width":128},{"text":"[gibberish]","width":128},{"text":"alright, awesome","width":256},{"text":"[gibberish]","width":256},{"text":"ah! great, happy days","width":128},{"text":"right, so let's run awesome","width":128},{"text":"hey! look at that!","width":256},{"text":"we wrote some c code, we connected to another machine!","width":192},{"text":"this is what it's all about, this is what makes 241 so powerful, right?","width":256},{"text":"now we can actually talk to any machine, and now i can run my machine, i can run this a hundred thousand times, and run a ddos attack on the internet","width":704},{"text":"don't do that","width":64},{"text":"because every server, of course, can log the ip address","width":512},{"text":"and log the content of what's being sent to it","width":192}]