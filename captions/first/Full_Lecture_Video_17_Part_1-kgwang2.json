[{"text":"Okay","width":64},{"text":"First interesting comment","width":128},{"text":"This actually claims to be a solution to the dining philosopher's. If you put dining philosopher's solution, this is one of the pages you find","width":704},{"text":"But, let's see if you, today are more intelligent, no more can do more system programming than the interweb","width":384},{"text":"Because today we're gonna find out if this code is correct or not","width":320},{"text":"Right so let's see how it works","width":192},{"text":"Remember, this is gonna be run for each philosopher","width":192},{"text":"so the first thing we'll do is we'll take that pointer that was passed and we'll cast it so now we've got a pointer for each thread","width":448},{"text":"each thread has its own pointer to that little struct that we've set up, okay?","width":256},{"text":"And let's see what we do then... okay, so","width":192},{"text":"Our philosopher has two states, right","width":320},{"text":"They're either sleeping or eating.","width":192},{"text":"Well, that's not quite true because we also have this middle state where we're trying to eat","width":256},{"text":"Right but most of the time philosophers get paid to sleep","width":384},{"text":"a.k.a. think, right? so","width":128},{"text":"Between 1 and 8 seconds, our philosopher's not doing much, just sleeping","width":320},{"text":"but occasionally, they wake themselves up with a fantastic thought","width":192},{"text":"\"I am! To be or not to be!\" Or something like that.","width":192},{"text":"And they say \"oh, I'm kind of hungry now!\" Right, this philosophy is kind of, uh... ha, makes me hungry.","width":320},{"text":"Right, so what do we do","width":128},{"text":"We get our two forks","width":64},{"text":"We announce that we're hungry","width":256},{"text":"and then we try to pick up, we try to lock our two mutexes","width":320},{"text":"now, here's some cleverness in this code here, here's a function we haven't seen before:","width":256},{"text":"we're gonna do something called \"trylock\"","width":320},{"text":"what trylock does is it trys to grab the resource, but rather than getting stuck, rather than blocking if that mutex is already locked, it just immediately returns.","width":768},{"text":"it immediately comes back to you and says \"I'm sorry, that resource is actually currently locked\".","width":512},{"text":"So, you can play again later if you want, but you didn't actually get to lock the resource","width":320},{"text":"So either two things happens:","width":64},{"text":"either you","width":128},{"text":"either you're not the resource and continue or it returns a non zero value and you continue","width":320},{"text":"right, so this code tries to avoid deadlock because you and I know","width":256},{"text":"something terrible could happen, right?","width":128},{"text":"something terrible... if every philosopher picked up their left fork first at exactly the same time,","width":384},{"text":"we've got a problem","width":128},{"text":"every philosopher will be holding onto their left fork trying to grab the right fork and they wouldn't because there's another philosopher saying \"get your grubby mitts off that, that's mine!\"","width":576},{"text":"Yes,","width":64},{"text":"so that's what we're trying to avoid; we use this \"trylock\" to prevent that.","width":256},{"text":"So what do I do if it failed? If it failed...","width":384},{"text":"We let go of our left fork.","width":256},{"text":"Brilliant, right? We got no hold and wait anymore. Alright, so, look at this:","width":384},{"text":"No hold and wait... We could actually annotate this code with some stuff that shows that we actually know a bit of computer science, or at least, more than the people at rosetta's","width":704},{"text":"Rosetta Code.","width":128},{"text":"Okay, so look, no hold and wait.","width":128},{"text":"And then we do something funky here:","width":448},{"text":"And we go around again.","width":128},{"text":"This, unfortunately, ladies and gentlemen, is where I stop talking, and your brain starts working.","width":576},{"text":"At this moment in time, I'm gonna ask you with either your imaginary friend or a neighbor of your choice, to figure out if this code is any good.","width":576},{"text":"If it is good, why? If it is not good, why?","width":320},{"text":"Okay, so I'm gonna give you a few minutes to look at this code and analyze it and be prepared to say something about it.","width":448}]