[{"text":"vice versa","width":64},{"text":"so what do they stand for? they stand for host to network short","width":320},{"text":"and network to host short","width":192},{"text":"[silence]","width":1152},{"text":"so here's an example","width":128},{"text":"where we want to specify the port","width":256},{"text":"as port 1100","width":128},{"text":"notice how I chose a port greater than 1024 ","width":256},{"text":"and I want to set it directly into this structure here","width":256},{"text":"socket address","width":192},{"text":"and so I have to remember to actually set this up to be the network","width":512},{"text":"the network port number","width":256},{"text":"so this port number is actually going to be passed directly into the network card we're going to assemble the packet and that packet will have these bytes in now the correct order to say okay [something] on this particular port","width":1088},{"text":"you can use these inside your own code","width":320},{"text":"let's say you wanted to have a high performance server","width":256},{"text":"and you're not going to send ascii information, you actually want to send binary information","width":256},{"text":"and you want to send say the position of your players to all of the other, you want to cast it out to all of the order players on your game server","width":704},{"text":"you would have to decide on your protocol to say am I going to send this out in little endian or big endian format","width":384},{"text":"and you could use these kinds of calls to make sure that it doesn't matter whether your C code is compiling on an ARM platform an Intel platform","width":640},{"text":"that we always on the network are sending bytes out in the same order","width":320},{"text":"same endianness ","width":128},{"text":"alright so that's just a little aside, you'll see these codes and now you know what they do","width":320},{"text":"and here's the other one where you use it for a long so you can use it for 32 bits","width":384},{"text":"right so okay right","width":320},{"text":"so it's quite often said that setting up a server takes four cores","width":256},{"text":"we better say what they are","width":128},{"text":"and it's a common exam question or interview question to say what's the order of these?","width":512},{"text":"and what does each one do?","width":128},{"text":"right so the first one is easy, hey we need a socket","width":192},{"text":"you're not going to get very far without a socket","width":192},{"text":"we need a way to configure our network","width":256},{"text":"and a socket gives us back a file descriptor that we can then start to use","width":256},{"text":"once we've got that file descriptor","width":128},{"text":"we want to bind it to a local port","width":576},{"text":"let's bind it so we are now going to be on a particular local part and we set it up, we pass it","width":1024},{"text":"now actually we're ready to go","width":256},{"text":"here's the nice thing that we can do with server sockets","width":192},{"text":"we can ask the kernel to do that little handoff trick and to start queuing up any connections","width":448},{"text":"so now we can start listening","width":128},{"text":"at that moment...","width":192},{"text":"we're live!","width":128},{"text":"our kernel is starting to actually accept connections for us","width":256},{"text":"and we'll generate a small queue of incoming connections that we can now start to process","width":384},{"text":"so with listen, we actually specify the queue size","width":320},{"text":"so as part of that little handoff process when we say oh actually go and reconnect to me next time on this other port number","width":704},{"text":"now the kernel has taken that and said okay by the way expect connections on this other port number, so internally its got a little queue","width":448},{"text":"when we want it from our user's side, we call...","width":384},{"text":"yes I'm prepared to accept this reverse call","width":256},{"text":"accept!","width":384},{"text":"so on the server side, when you call accept, you get...","width":640},{"text":"a new file descriptor","width":256},{"text":"okay so here's a big gotcha","width":256},{"text":"is that you've now actually got two file descriptors to play with","width":320},{"text":"if you want to be talking to your clients that are connecting","width":192},{"text":"this is one","width":128},{"text":"you get a new file descriptor each time accept returns","width":320},{"text":"also, this blocks","width":320},{"text":"until we have a client","width":576},{"text":"if your code is a bit slow in calling accept","width":320},{"text":"don't panic, that's why we called listen","width":192},{"text":"listen says look uhh my user code may not be able to call it except immediately so have a little backlog of connections that the kernel will maintain","width":640},{"text":"and hopefully I'll be able to call accept in the future","width":192},{"text":"so its very simple code, very simple server","width":320},{"text":"we can just call accept once, and that's it and that's what we'll do in a demo in a moment","width":256},{"text":"later can call accept in the loop to process one client at a time","width":320},{"text":"probably not going to be the best webserver in the world","width":320},{"text":"but hey it works and we can run that on some tiny embedded hardware","width":256},{"text":"later we might do things like hey let's for every accept call start a new thread","width":448},{"text":"and then everybody can talk to my server in parallel","width":256},{"text":"well that works until a thousand people try to connect and then you have a thousand threads that start on a machine with 8 CPUs that's probably going to work out so great","width":768},{"text":"so then we need to start figuring out even better ways to have a high performance server","width":448},{"text":"but anyways that's our four calls, socket, bind, listen and accept","width":256},{"text":"alright let's see this in action","width":256},{"text":"ooh look code!","width":192}]