[{"text":"So we have a problem, yeah?","width":326},{"text":"we have invented virtual memory, but we have halved the running speed of our machine","width":416},{"text":"this might be a difficult thing to sell in the marketplace if we half the speed","width":352},{"text":"so we need to do something about this","width":114},{"text":"okay we can have caches, etc but we still got the problem","width":258},{"text":"Now, we've invented virtual memory which is great, we don't have to worry have fragmentation so much","width":544},{"text":"but we halved the speed","width":299},{"text":"we halved the speed because we're doing this lookup","width":174},{"text":"alright, lets see what happens when we use a two level page design","width":483},{"text":"so why might be care about two level page design","width":344},{"text":"well lets do a similar calculation but for a 64 bit system","width":447},{"text":"lets keep our page sizes at 4096 bytes","width":741},{"text":"so, what is this? this is 12 bits... so if thats my offset. how many bits do i have for my page number?","width":978},{"text":"64 - 12. i got 52 bits left","width":604},{"text":"thats gonna be used for my lookup table, alright? so","width":637},{"text":"how big is my lookup table gonna be?","width":190},{"text":"2^52","width":127},{"text":"how big is 2^52?","width":472},{"text":"okay so how do we work this out roughly. well 2^10 is a 1000.","width":425},{"text":"so","width":648},{"text":"okay its a little big","width":151},{"text":"this is the number of entries i'll need inside my page table","width":170},{"text":"i better go home and and buy a lot of memory just to store my page table","width":425},{"text":"so what worked really well in 32 bits is completely falls over in 64 bit land","width":343},{"text":"because, we... heh. our page table is just too large!","width":552},{"text":"BUT","width":70},{"text":"to quote black adam","width":109},{"text":"\"we have a cunning plan.. we'll have a cunning plan\"","width":260},{"text":"We will use a multilevel page table","width":287},{"text":"because, our address space is huge, but guess what: most of it is unused!","width":651},{"text":"so, let's split this 52 bits up into multiple lookups","width":850},{"text":"so we'll take this and split it up into pieces. uh, we'll um","width":762},{"text":"lets start it with just two. so the idea is that","width":271},{"text":"I've got an initial lookup here","width":359},{"text":"lets say that its, that we use um... i dunno.. 10 bits?","width":519},{"text":"sometimes they only uses 4, but this is matter of example","width":340},{"text":"so we use the upper most 10 bits","width":203},{"text":"some of these can be empty, they may not refer to anything. they may not be used in that huge swath of address space","width":397},{"text":"we dont even need an entry in here","width":228},{"text":"so lets say that the lowest and highest entries are used here","width":290},{"text":"so this will point to another page table ","width":326},{"text":"with a whole lot of entries, lets say in this one, we have twelve bits","width":546},{"text":"and these entries may or may not be filled, but they dont refer to frame numbers yet. i can keep playing this game for as long as i want","width":619},{"text":"until i got up to a total of 52 bits","width":284},{"text":"alright so how many bits have i used up so far... twenty twentytwo.... ","width":282},{"text":"so now ive got","width":271},{"text":"thirty bits, for example in my last one:","width":279},{"text":"and so on","width":163},{"text":"so ive just invented a little page table system here, a multilevel page system, where","width":436},{"text":"to convert the page number to a frame number, i now have to do one two THREE memory reads","width":853},{"text":"and each of these can point to a different table","width":330},{"text":"right so this one will point to a different area of memory... just say okay","width":280},{"text":"these are the entries in here, they may or may not be filled","width":326},{"text":"and","width":91},{"text":"so on","width":251},{"text":"so now i've made my 64 bit machine even slower than my 32 bit machine, right?","width":309},{"text":"now a single read or single write now takes 4 memory looks up","width":345},{"text":"the actual read itself and all these page table look upss","width":454},{"text":"if I was working at Intel at this point, I think i'd be fired, yeah?","width":269},{"text":"we've come up with a machine that is now twice as fast as last years model","width":254},{"text":"but dont worry its got a bigger number on the box, so people are gonna buy it","width":263},{"text":"right","width":92},{"text":"so this is the idea: so we've got a basic idea of how to split this up with the idea that we can do multiple table looks ups","width":735},{"text":"we have just got a little bit of a problem that most of the time, its incredibly slow","width":212},{"text":"so in a little bit, we'll talk about how to fix that","width":405},{"text":"alright so lets do this","width":181},{"text":"we'll work this out on a 32 bit system","width":333},{"text":"and for a two level page table example, we'll say we'll have 10 bits","width":507},{"text":"wait a moment, i wanna get up to uh yeah, 32","width":162},{"text":"okay, and then um","width":137},{"text":"12 bits for offset","width":426},{"text":"so how many memory reads are require to read a byte at this address","width":190},{"text":"well you wanna do a read first of all, you go to top level page table.","width":388},{"text":"this gives you the address of the next page table and finally this gives you the frame number","width":748},{"text":"for memories","width":50},{"text":"so in a two level page table, we are running at three memory reads for every actual read or write that you wanna do","width":674},{"text":"sorry. three memory accesses that your program tries to do.","width":377},{"text":"so we're three times as slow","width":424},{"text":"so this is a great system that allows us to have virtual memory, but as i keep saying: ITS SLOW","width":355},{"text":"so whats the fix?","width":141},{"text":"the fix is this...","width":126},{"text":"translation lookaside buffer","width":192}]