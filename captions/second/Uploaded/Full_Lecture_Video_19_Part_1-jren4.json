[{"text":"Okay, so other thing to do then is to be the child","width":372},{"text":" As a child, you want to write from this","width":93},{"text":" Okay, so how can we do this? Well one low level way of doing without the c-library is to do directly call read, and if you call read, you need say which file descriptor and so, that would be fds 0","width":922},{"text":" You need to say, Hey here I got some buffer, I got some memory you can use, and also say how many bytes I am prepared to accept","width":586},{"text":" so if I were to make, for example, a little space on my stack here","width":365},{"text":" I could then say read into the buffer, and here is the size of my array","width":537},{"text":"Now if you call read like this, of course you may not get a thousand twenty four bytes","width":444},{"text":" So actually we should see how many bytes we got","width":231},{"text":"So here is the number of bytes and we expect that to be greater than zero","width":340},{"text":" In fact, read will block until we get some bytes out of that pipe","width":422},{"text":" Okay, what should we do with this bytes?","width":81},{"text":" Well, let's for now print out \"Hurray I can't some bytes\"","width":655},{"text":" say the number, and we could say, read what happens","width":284},{"text":" Right, and you can perhaps guess what might happen here","width":150},{"text":" So we want to say we got this number of bytes and here is our buffer","width":526},{"text":" Okay, and I'll do a new line, so we flush this","width":294},{"text":" Right so let's try this and see what we get","width":836},{"text":"Alright, so parent sent some bytes, and \"Hurrag I cant some bytes\"","width":374},{"text":"\" Right, so my typing today is a little off","width":149},{"text":"But we saw six bytes, and we saw \"Hello","width":206},{"text":"\" Now, one two three four five","width":424},{"text":" We were lucky in this case","width":165},{"text":" Why were we lucky? Yes! correct, we didn't send the null byte","width":564},{"text":" We sent \"Hello\" and then new line, which happen to be six bytes","width":223},{"text":" But we never actually sent a null byte","width":123},{"text":" We chose to not send a null byte","width":91},{"text":" We just sent it as bytes","width":96},{"text":" And the operating system doesn't care","width":99},{"text":" It just says \"Okay we got some bytes from my parent\"","width":201},{"text":"got some bytes from pipes that stick them down, and later it says \"Okay we'll read this many bytes\"","width":349},{"text":"So, our code is actually dangerous","width":183},{"text":" Our code could have printed out gibberish after the \"Hello","width":547},{"text":"Let's fill up our buffer with some garbage, right","width":303},{"text":" Let's put an extra character in there","width":1225},{"text":" And you'll see that we manage to print out the hash as well","width":288},{"text":" which is not a part of the message","width":264},{"text":" So our mistake here is that we forget that the string has a null byte, and if you want to do string processing on the byte that you get back, remember to include the null byte","width":703},{"text":" Either send it explicitly down your pipe or add it afterwards","width":452},{"text":"The operating system doesn't know that you're sending a string data","width":200},{"text":" It's just bytes as the operating system concerned","width":185},{"text":" It's just Hey, I'm gonna put this on the memory","width":133},{"text":" Here's some bytes to send the pipe","width":300},{"text":"So, what could we do with this","width":396},{"text":" One common thing to do is to include special character in the end of our message","width":320},{"text":" Maybe a null byte, for example","width":101},{"text":" Or another character to say \"Okay, I'm not going to send anymore data\" So, if I for example, I could say I know that my normal data would never use an exclamation point","width":788},{"text":" So that my reader would say, Oh look, I just saw an exclamation point","width":287},{"text":"I now know that was the special terminator to say that okay my parent is done with me, and it's never gonna send any more data","width":539},{"text":"So telling the reader that you have no more data is easy","width":301},{"text":" You could just simply include a special character","width":266},{"text":"Okay, so telling the reader, you just send something special You send \"Okay, good bye\", and then you write a little bit of code and say, \"Oh look, I've just got the final piece of information","width":962},{"text":"I know there is no more data coming","width":249},{"text":"There is another problem, which is \"What if the reader closes and the writer doesn't know\"","width":638},{"text":"And we will return to that in the second half of the lecture, so this just a quick introduction to pipes","width":522},{"text":" Look they are pretty easy and now they can give you a form of inter-process communication","width":332},{"text":" If you want your child and your parent to send stuff to each other, guess what? You need two pipes","width":600},{"text":"And, I deliberately didn't tell you one more detail, which we will review in a little bit","width":545},{"text":" About closing these file descriptors","width":162},{"text":" This is kind of naive version of pipes","width":201},{"text":" We'll come back just in a little bit","width":174},{"text":" Instead, we'll gonna talk about fseek and ftell","width":314},{"text":" Unless any has any quick question","width":417},{"text":"No quick question","width":113},{"text":" So the comment here is \"Whoops, we should be closing stuff\"","width":100},{"text":"And we should be closing stuff here too","width":846},{"text":" Okay","width":273},{"text":" Alright, so let's do fseek and ftell","width":546},{"text":"Alright, so the next thing we'll talk about is our file descriptor, when it talk to a normal file when we call let's say open or fopen a file","width":636},{"text":" Have a position","width":66},{"text":" Right? We can say Okay give me the next line","width":141},{"text":"Say call read line","width":84},{"text":" Or read the following next 8 bytes","width":264},{"text":"And every time we talk to a file descriptor then, we're changing the position in a file","width":396},{"text":" So the operating system is keeping track of that","width":220},{"text":" We can change it","width":222},{"text":" One other cool thing we can actually do is jump to the very end of the file","width":465},{"text":"So, why might that be useful? Okay, we want to write some data again","width":610},{"text":" Suppose you want to know how big your file was is the plan","width":487},{"text":" Move the file descriptor, so it's right at the end of the file, and then say \"Excuse, what position am I?\" And that tell's you how big the file is","width":684},{"text":" So please tell me my current position","width":287}]