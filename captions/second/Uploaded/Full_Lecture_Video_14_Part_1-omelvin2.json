[{"text":"so did anyone come up with a way to not deadlock our writers without telling me the code what would your approach be to not let the writers deadlock?","width":1098.1818182468414},{"text":"so one way would be to broadcast to the writers first then the readers","width":294.18181824684143},{"text":"im not sure that would entirely fix the problem because even if i broadcast the writers","width":364.18181824684143},{"text":"wait let's go back to this code for a second","width":218.18181824684143},{"text":"even if i broadcast here to the writers","width":167.18181824684143},{"text":"the writer will wake up but there's still readers inside and it'll still block","width":245.18181824684143},{"text":"so it's a good try ","width":105.18181824684143},{"text":"so it's the right approach you have to do somehting that gives preference to the writers","width":303.18181824684143},{"text":"that's how we're gonna fix this. say that one more time","width":1227.1818182468414},{"text":"so one thing you can do is put a number of make sure no one reads forever","width":361.18181824684143},{"text":"so the solution i have is not gonna break the problem of someone reading forever","width":325.18181824684143},{"text":"if somebody reads forever i'm never gonna let a writer in","width":206.18181824684143},{"text":"so ummm ","width":149.18181824684143},{"text":"that is a limitation of the solution i'm gonna show you","width":215.18181824684143},{"text":"even if you just let even if you say that your reader can be in there for 10 seconds","width":372.18181824684143},{"text":"let's do it that way","width":55.18181824684143},{"text":"instead of giving it a time limit","width":150.18181824684143},{"text":"you can still have every second a reader comes along","width":281.18181824684143},{"text":"so probably we should put a limit on the solution i'm gonna show you","width":236.18181824684143},{"text":"to make sure that the reader's not gonna stay in forever","width":753.1818182468414},{"text":"it would be really good if we could have them enter in the order in which they receive","width":229.18181824684143},{"text":"did anybody come up with a solution kinda like that?","width":600.1818182468414},{"text":"yeah, that's pretty close to what I'm gonna do","width":117.18181824684143},{"text":"so basically what i'm gonna show you is a way to say ok","width":195.18181824684143},{"text":"i have a waiting flag","width":125.18181824684143},{"text":"if a writers coming in and writer's waiting i'm gonna send a waiting flag","width":263.18181824684143},{"text":"and if there's a writer waiting","width":109.18181824684143},{"text":"i'm not gonna let anymore readers in","width":140.18181824684143},{"text":"and whatever reader are in i'm gonna drop through","width":208.18181824684143},{"text":"and those readers once they're done ","width":156.18181824684143},{"text":"the writers next","width":112.18181824684143},{"text":"and i'll show you how that works","width":255.18181824684143},{"text":"you know what i have the code here not gonna write the whole thing down","width":526.1818182468414},{"text":"we can look over it","width":58.18181824684143},{"text":"ok so here's my reader and my writer","width":234.18181824684143},{"text":"so i've added ","width":213.18181824684143},{"text":"here","width":63.18181824684143},{"text":"i now have two","width":184.18181824684143},{"text":"two counters","width":159.18181824684143},{"text":"that have to do with readers instead of just 1","width":216.18181824684143},{"text":"this one says that i have a want to enter the critical section. so this one says \"writer's waiting\"","width":753.1818182468414},{"text":"and this one says","width":178.18181824684143},{"text":"writers writing","width":522.1818182468414},{"text":"what value can this one have","width":442.18181824684143},{"text":"what value can the writers waiting hve","width":326.18181824684143},{"text":"okay what value can this one have","width":144.18181824684143},{"text":"the writers writing","width":95.18181824684143},{"text":"just one","width":38.18181824684143},{"text":"how about this one here","width":175.18181824684143},{"text":"no","width":46.18181824684143},{"text":"i can have lots of writers writing","width":157.18181824684143},{"text":"it just tells me that there are writers waiting","width":149.18181824684143},{"text":"okay and as long as there's waiting","width":312.18181824684143},{"text":"this one says as long as there's writers waiting instead of writers writing","width":292.18181824684143},{"text":"i'm gonna block my reader","width":165.18181824684143},{"text":"and","width":61.18181824684143},{"text":"this part","width":129.18181824684143},{"text":"right here","width":73.18181824684143},{"text":"says that as long as there's a writer writing","width":142.18181824684143},{"text":"i'm not gonna drop out of my condtion wait while loop","width":308.18181824684143},{"text":"okay","width":53.18181824684143},{"text":"so what's gonna happen is 1 writer's gonna come along","width":265.18181824684143},{"text":"it's going to ","width":226.18181824684143},{"text":"say that somebody's reading say we have 1 reader  in there","width":137.18181824684143},{"text":"let's let the reader go first","width":117.18181824684143},{"text":"reader comes in ","width":188.18181824684143},{"text":"i need my variables set here","width":157.18181824684143},{"text":"so we have","width":146.18181824684143},{"text":"writers ","width":139.18181824684143},{"text":"writing","width":93.18181824684143},{"text":"and","width":53.18181824684143},{"text":"reading","width":310.18181824684143},{"text":"and they all start off as","width":175.18181824684143},{"text":"0","width":202.18181824684143},{"text":"so i have a reader that comes along","width":141.18181824684143},{"text":"it's gonna come along here and check to see if there's writers it's gonna say no no writers","width":293.18181824684143},{"text":"so ","width":76.18181824684143},{"text":"uhh","width":38.18181824684143},{"text":"it's gonna fall through the condition variable i don't have to wait and then it's gonna increment writing, reading i'm sorry","width":429.18181824684143},{"text":"it's gonna stay in reading here for a second","width":120.18181824684143},{"text":"let's leave it there for a minute","width":125.18181824684143},{"text":"to make sure that the writers are gonna be able to get through","width":222.18181824684143},{"text":"so now i have a writer its gonna incrament it's gonna acquire the lock so it can change the writers value ok so now i have one writer waiting","width":628.1818182468414},{"text":"but now i need to check somebody's reading am i gonna fall out of this loop?","width":363.18181824684143},{"text":"yes or no","width":323.18181824684143},{"text":"can i pass this line?","width":354.18181824684143},{"text":"alright i'm gonna do while reading or writing am i reading or writing?","width":283.18181824684143},{"text":"yes","width":32.18181824684143},{"text":"so i do my condition wait","width":71.18181824684143},{"text":"so now my first writer is blocked here","width":368.18181824684143},{"text":"and","width":41.18181824684143},{"text":"what happens when it calls the condition variable?","width":167.18181824684143},{"text":"it releases the lock","width":202.18181824684143},{"text":"so","width":111.18181824684143},{"text":"and now i have another writer come along","width":149.18181824684143},{"text":"same thing happens i'm gonna increment my writers to 2","width":223.18181824684143},{"text":"and my second one ","width":113.18181824684143},{"text":"is gonna block right there","width":148.18181824684143},{"text":"is that clear?","width":68.18181824684143},{"text":"yeah?","width":653.1818182468414},{"text":"nothing's happened yet right we haven't been signaled yet so now","width":237.18181824684143},{"text":"let's go back to this reader","width":103.18181824684143},{"text":"so this reader's done","width":340.18181824684143},{"text":"it gets the lock it decrements reading now to 0","width":266.18181824684143},{"text":"and","width":45.18181824684143},{"text":"it signals everyobdy","width":169.18181824684143},{"text":"that will wake up it's doing a signal broadcast","width":193.18181824684143},{"text":"it will wake up both of the writers","width":256.18181824684143},{"text":"both of the writers will acquire the lock 1 at a time","width":214.18181824684143},{"text":"right they're not gonna do it at the same time","width":85.18181824684143},{"text":"the first one that acquires the lock will say ","width":152.18181824684143},{"text":"is reading 0?","width":113.18181824684143},{"text":"yes","width":36.18181824684143},{"text":"is writing 0?","width":81.18181824684143},{"text":"yes","width":63.18181824684143},{"text":"so","width":35.18181824684143},{"text":"that one can fall throgh","width":151.18181824684143},{"text":"and","width":30.18181824684143},{"text":"it can now","width":170.18181824684143},{"text":"set writing to 1","width":157.18181824684143},{"text":"and there's somebody writing","width":174.18181824684143},{"text":"ok","width":87.18181824684143},{"text":"so now","width":74.18181824684143},{"text":"if you look at another reader coming along","width":253.18181824684143},{"text":"it's gonna say is there are there writers waiting?","width":252.18181824684143},{"text":"yes","width":56.18181824684143},{"text":"ok now wait","width":377.18181824684143},{"text":"what did i just trade off","width":170.18181824684143},{"text":"this is not a perfect solution either","width":158.18181824684143},{"text":"yeah?","width":183.18181824684143},{"text":"there's no better way for the readers so i now put the priority on the writers instead of on the readers","width":481.18181824684143},{"text":"there are solutons","width":195.18181824684143},{"text":"for having counters and allowing them to go in step by step i don't think lawrence was having you going through the priority solutions so this is the one he wanted me to go through with you","width":1051.1818182468414}]