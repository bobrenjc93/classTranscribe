[{"text":"what we'll do we'll make a very simple piece of virtual memory","width":637},{"text":"and we'll let the hardware people actually make it real right?","width":216},{"text":"we're going to do it just today, the kind of five minute version and we'll let someone else worry about the actual hardware details","width":589},{"text":"here's the game we're going to play","width":181},{"text":"memory, real memory of course is expensive","width":306},{"text":"we'd love to have more of it but we're always constrained by the cost of memory","width":300},{"text":"the only really really great thing about memory is that it doesn't take up too much power","width":562},{"text":"we would like to be able to have processes that can actually use more memory than we physically brought","width":548},{"text":"we would like to have more than one processes believing that they've got all the memory in the world and that's where virtual memory comes in","width":496},{"text":"we're going to say make the addresses that the processes use","width":342},{"text":"only indirectly correspond to the actual ram or actual physical memory that we have on the machine","width":561},{"text":"so we need to do some sort of lookup","width":138},{"text":"anytime your process actually does a read or write","width":214},{"text":"we actually at the end of the day need to connect that to some RAM","width":173},{"text":"we actually need to connect it to a physical address","width":609},{"text":"so here is my physical address","width":293},{"text":"and what I'm going to do is divide it up into chunks","width":328},{"text":"and these chunks are called pages","width":401},{"text":"and I'm going to work with pages which are about 4000 bytes, 4096 bytes","width":850},{"text":"so when are we going to use this memory? ah all the time of course right?","width":424},{"text":"so if you've got an instruction like a CPU instruction that says okay increment register A","width":680},{"text":"just reading the instruction has to be in memory somewhere","width":446},{"text":"if you've got an instruction that says load from address 47000","width":337},{"text":"not only do we need the opcodes to be in memory, we need 47000 to correspond to some memory","width":446},{"text":"so I'm using my virtual memory addresses all the time","width":172},{"text":"not just for the data but for the code as well","width":198},{"text":"anytime you write a line of C code, this virtual memory lookup is happening for every single one of those","width":371},{"text":"we need to be able to somehow translate our virtual memory address into a place in memory","width":837},{"text":"so here's the big trick","width":183},{"text":"take your virtual memory address, get a really sharp knife and cut it conceptually into two pieces","width":344},{"text":"preheat the oven to two hundred degrees... no forget that bit, right","width":240},{"text":"we've got the lowest twelve bits which we are just simply going to ignore for now","width":305},{"text":"because what we'll do with those is that we'll just simply use them as an offset","width":600},{"text":"in other words, once I've decided which piece of memory, which memory frame or physical frame","width":490},{"text":"which page I'm going to use here","width":185},{"text":"Of those 4096 bytes, I need to tell you which of those I'm going to use and that's where my 12 lowest bit comes into play because guess what 2^12 is 4096","width":636},{"text":"so I can use those lowest twelve bits as just an offset into any one of these particular things","width":533},{"text":"the remaining bits and because I'm working in a little 32 bit system, I now need to map to memory","width":810},{"text":"okay so first of all, how many of these 2^20, how many bit combinations is that? how big is 2^20","width":1027},{"text":"okay well let's, i'll give you a clue, it's 2^10 times 2^10 how big is 2^10?","width":623},{"text":"2^10 is 1024","width":182},{"text":"so we're talking 1024 squared in other words a million","width":440},{"text":"a binary million","width":120},{"text":"a megabyte","width":86},{"text":"I've got a million entries, a million possible numbers up here","width":545},{"text":"we're gonna give these numbers a name","width":276},{"text":"we're going to call this the page number","width":582},{"text":"and we better give these pieces of memory a name","width":281},{"text":"we're gonna call them frame","width":345},{"text":"so, I need to convert one to the other","width":351},{"text":"right so page frame a miracle occurs we map it to a particular frame","width":734},{"text":"here's a really easy way to do it","width":134},{"text":"let's just have a table in memory","width":297},{"text":"of a million entriese","width":118},{"text":"right so we take our twenty bits","width":211},{"text":"somewhere in memory in a well defined location","width":646},{"text":"we need a table big enough for 2^20 entries","width":580},{"text":"and these just hold the frame number","width":172},{"text":"so if your looking say at this one","width":297},{"text":"then it turns out that you're going to use this particular frame of memory","width":377},{"text":"if you're looking at this piece of memory, it turns out that you need this one","width":394},{"text":"if you're looking at this piece of memory, it turns out that you need this one","width":459},{"text":"if you're looking at this piece of memory, haha, no it turns out that you can't look at that piece of memory","width":396},{"text":"if you try to look at that piece of memory, BOOM, we're gonna blow your process up","width":491},{"text":"do you remember things like seg faults?","width":187},{"text":"this is it!","width":112},{"text":"this is at that moment when we try to look at a particular page number","width":211},{"text":"and we say ah hah guess what, that's not actually mapped to any real memory","width":257},{"text":"ah ah ah, you can't do that!","width":281},{"text":"so we can now protect portions of our memory, we don't actually have to map all those addresses","width":315},{"text":"so when we say to our process hey pick a memory location, pick any memory location, do you feel lucky punk?","width":368},{"text":"alright if our programs are well written then we'll stick on the valid page numbers","width":363},{"text":"if their not then our operating system, our kernel will notice that it's trying to read an impossible entry inside here","width":720},{"text":"right okay so this is called a page table","width":363},{"text":"and we have one of these for each process","width":361},{"text":"alright let's see if you're awake ","width":123},{"text":"I know it's up silly question it's a friday. um, let's um","width":338},{"text":"let's figure out this, what would happen if we could actually write to our own page table?","width":569},{"text":"how machiavellian do you feel today?","width":264},{"text":"what could you do if you could change your own page table","width":256}]