[{"text":"alright good afternoon class","width":205.18181824684143},{"text":"now so today we have quite a few pretentives in the orders","width":236.18181824684143},{"text":"if you traveled here because you ... cs 241 but ur just visiting the class today","width":409.18181824684143},{"text":"please just wave your hand","width":126.18181824684143},{"text":"i know theres quite a few of you","width":83.18181824684143},{"text":"right","width":24.18181824684143},{"text":"these people I invited just been accpeted to cs major program","width":321.18181824684143},{"text":"or they are visiting campus","width":143.18181824684143},{"text":"so be sure to be nice to them and tell them","width":221.18181824684143},{"text":"what a great place wisconsin is","width":248.18181824684143},{"text":"so here's what we are going to do today","width":67.18181824684143},{"text":"we are going to finish our discussion about sockets","width":239.18181824684143},{"text":"uhh in terms of .. what we can do is we use imports, and ","width":330.18181824684143},{"text":"what happens if","width":88.18181824684143},{"text":"is my mic on yet","width":143.18181824684143},{"text":"what happens if we dont set various socket options when we are developing our programs","width":327.18181824684143},{"text":"and we discover that the port is in use","width":107.18181824684143},{"text":"and that kind of stuff","width":88.18181824684143},{"text":"and then we talk about how can we make the server actually discover who is connected to us so we can find out for example","width":657.1818182468414},{"text":"its ip address","width":103.18181824684143},{"text":"so yesterday you made yik yak, or at least use a very simple version of yik yak, where we connect to our virtual machines","width":495.18181824684143},{"text":"on the android tablet","width":92.18181824684143},{"text":"and now that we want to make it so that our server can actually find out who connected it","width":350.18181824684143},{"text":"a little story for you","width":88.18181824684143},{"text":"that is the very first time i visited urbana champaign","width":147.18181824684143},{"text":"was I was visiting wolfram research","width":119.18181824684143},{"text":"they're just down the road, you may have heard of them","width":113.18181824684143},{"text":"they made methametica","width":141.18181824684143},{"text":"i did some 3d visualization software which connected to wolfram using sockets","width":374.18181824684143},{"text":"they connected to mathematica using sockets","width":134.18181824684143},{"text":"and this is back in the day when we actually made a plugin ","width":263.18181824684143},{"text":"an external piece of software","width":98.18181824684143},{"text":"to display 3 dimensional shapes","width":204.18181824684143},{"text":"so i was talking to them","width":63.18181824684143},{"text":"and back in the older days of the web, before blogs","width":305.18181824684143},{"text":"and they said, you know, one trick what we do, about our web server, is we got various competitors right now","width":383.18181824684143},{"text":"and we dont want them to know immediately when we release our product","width":272.18181824684143},{"text":"so when they come to our website, we check their ip address of the connection and we serve them the old content","width":493.18181824684143},{"text":"so our competitors see our content at least two days old","width":303.18181824684143},{"text":"so they'll be a bit slow in discovering when we actually release new software","width":239.18181824684143},{"text":"so that's something you can play with","width":107.18181824684143},{"text":"with the yik yak implementation ","width":239.18181824684143},{"text":"that give bad inforamtion","width":140.18181824684143},{"text":"if you don't like the client connecting to your server","width":182.18181824684143},{"text":"hey, give them something, give them some alternative information","width":280.18181824684143},{"text":"ok","width":50.18181824684143},{"text":"so","width":48.18181824684143},{"text":"how can you do that? easy!","width":104.18181824684143},{"text":"look at, say, the ip address, the bytes they sending to you","width":267.18181824684143},{"text":"you could invent a new protocal","width":113.18181824684143},{"text":"all messages to you should have a hash value","width":176.18181824684143},{"text":"which should start with a colon etc. etc. etc","width":210.18181824684143},{"text":"and why not share your protocol with your friends at cs 241","width":287.18181824684143},{"text":"so that you can connect to each others' virtual machines","width":208.18181824684143},{"text":"and why not tell some bad information to the people you dont like in cs 241","width":258.18181824684143},{"text":"and then you can tell them when the exam's on when they re not","width":305.18181824684143},{"text":"alright ","width":23.18181824684143},{"text":"so","width":36.18181824684143},{"text":"lets go out for our handout for today","width":201.18181824684143},{"text":"uhh we need","width":163.18181824684143},{"text":"i can ... some content today","width":167.18181824684143},{"text":"alright what's the honey pot","width":202.18181824684143},{"text":"easy! a place for honey! remember this?","width":145.18181824684143},{"text":"we can make servers that masquarade as real machines ","width":253.18181824684143},{"text":"and then uhh see how they've","width":312.18181824684143},{"text":"been used on internet","width":95.18181824684143},{"text":"for example, what you see in todays lecture","width":121.18181824684143},{"text":"is how can we discover what client is connecting to our server","width":335.18181824684143},{"text":"so we can label those ip addresses","width":145.18181824684143},{"text":"you could for example on your virtual machine","width":127.18181824684143},{"text":"have a port 80 open up ","width":110.18181824684143},{"text":"and see if anybody tries to connect to your machine","width":308.18181824684143},{"text":"okay so","width":183.18181824684143},{"text":"what are the purpose of these calls, htons and ntohs?","width":364.18181824684143},{"text":"Â what do they do?","width":233.18181824684143},{"text":"yes host to network and network to host","width":220.18181824684143},{"text":"why do we need this?","width":85.18181824684143},{"text":"well because if we gonna be transfer bytes to each other we should agree on what order we should send the bytes","width":379.18181824684143},{"text":"for example if we are talking about an integer of two bytes long, we are sending the low byte or the high byte first","width":360.18181824684143},{"text":"and our cpu may not respect that perticular ordering","width":261.18181824684143},{"text":"and in fact if you on a intel machine it is actually the wrong order","width":328.18181824684143},{"text":"ok so we can use these to make sure that any integer values we send as binary are correctly ordered, that we put them in the right order","width":673.1818182468414},{"text":"for either working in our cpu or sending out on the wire we send it to the network card","width":372.18181824684143},{"text":"ok so its time for host to network short, network to host, short","width":272.18181824684143},{"text":"so we'd use this, for example, when working with port numbers","width":215.18181824684143},{"text":"umm port numbers are 16 bits","width":135.18181824684143},{"text":"ok so what are the four calls with the network server","width":148.18181824684143},{"text":"we've done this already","width":46.18181824684143},{"text":"remember","width":39.18181824684143},{"text":"our basic idea is we want to make a socket","width":302.18181824684143},{"text":"we'll say what kind of socket","width":91.18181824684143},{"text":"right","width":41.18181824684143},{"text":"then well call bind","width":111.18181824684143},{"text":"because we want to bind to a particular local port","width":367.18181824684143},{"text":"we may also use it to bind to a particular network card","width":313.18181824684143},{"text":"so weve made actual socket now so how do we get started","width":302.18181824684143},{"text":"we call listen","width":113.18181824684143},{"text":"all of these things will happen very quickly","width":183.18181824684143},{"text":"the next one will block, and that is when we call accept","width":345.18181824684143},{"text":"accept now will block if there is no one trying to connect to our server. ","width":233.18181824684143},{"text":"so it only returns when a client has actually connected. ","width":318.18181824684143},{"text":"why do we call listen?","width":73.18181824684143},{"text":"because we may want to set up a small","width":162.18181824684143},{"text":"queue so that if multiple clients connects together, the operating system is prepared to look after those immediate connections until we get them from accept","width":812.1818182468414},{"text":"and each time you accept, you get a new file descriptor","width":174.18181824684143},{"text":"and each time the client connects, it gets a new port to talk to","width":293.18181824684143},{"text":"alright so we've seen that","width":61.18181824684143},{"text":"now","width":32.18181824684143},{"text":"one thing i didnt talk about before","width":123.18181824684143},{"text":"was","width":237.18181824684143},{"text":"freeaddrinfo","width":70.18181824684143},{"text":"yes we've been playing with getaddrinfo","width":146.18181824684143},{"text":"to fill in a pointer to that struct ","width":332.18181824684143},{"text":"and remember that struct actually could be a linked list","width":299.18181824684143},{"text":"so when we finished using it","width":175.18181824684143},{"text":"rather than having to walk through the linked list ourselves","width":181.18181824684143},{"text":"there happens to be something called freeaddrinfo that does this for us","width":227.18181824684143},{"text":"and of course that is going to pull out the next pointer before calling free on each struct","width":417.18181824684143},{"text":"so what do you think might be wrong with this little piece of code here?","width":253.18181824684143},{"text":"you can assume that inside the dot dot dot i've called memset on hints and i set up the hints struct correctly ","width":434.18181824684143},{"text":"umm but what do you think mistake i might have made in writing this little bit of code","width":664.1818182468414},{"text":"make a pointer, called getaddrinfo, and then I called this function called free to say ","width":315.18181824684143},{"text":"ok, free that linkedlist that getaddrinfo set up for me","width":324.18181824684143},{"text":"what could possibly go wrong?","width":346.18181824684143},{"text":"yes?","width":164.18181824684143},{"text":"oh should i pass the address","width":93.18181824684143},{"text":"actually no freeaddrinfo takes a pointer to the first struct and go through destructively and frees up each member of the list ","width":618.1818182468414},{"text":"okay time to put your, yes","width":307.18181824684143},{"text":"thank you","width":31.18181824684143},{"text":"yes","width":47.18181824684143},{"text":"right","width":62.18181824684143},{"text":"so, remember we need to ask ourselves what could possibly go wrong","width":283.18181824684143},{"text":"ok here's one possibility ","width":116.18181824684143},{"text":"suppose getaddrinfo failed","width":181.18181824684143},{"text":"for example, you haven't actually connected to the wifi so it cant do the domain name lookup and find ip address","width":712.1818182468414},{"text":"so suppose getaddrinfo fails","width":128.18181824684143},{"text":"that means it never changed this pointer","width":163.18181824684143},{"text":"","width":64.18181824684143}]