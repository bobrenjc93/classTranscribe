[{"text":"right so we'll just say hey we don't care","width":186.18181824684143},{"text":"we'll let all of the signals interrupt us","width":228.18181824684143},{"text":"right so that's a quick outline of this","width":129.18181824684143},{"text":"let's have a look at page two","width":259.18181824684143},{"text":"cause we're going to use it","width":214.18181824684143},{"text":"alright let's fix the code we wrote at the very beginning of the semester then","width":264.18181824684143},{"text":"when we talked about eating zombies","width":226.18181824684143},{"text":"how do we eat zombies? we call waitpid on them","width":225.18181824684143},{"text":"on the parent","width":533.1818182468414},{"text":"so our problem is that this signal handler","width":303.18181824684143},{"text":"isn't going to be called every time a child exits","width":274.18181824684143},{"text":"because if I have two children exiting at the same time, I might only get one signal","width":324.18181824684143},{"text":"remember? if a signal is pending, it has been generated","width":223.18181824684143},{"text":"I don't start queuing them up","width":159.18181824684143},{"text":"so if I had two children finishing at about the same time","width":291.18181824684143},{"text":"or if I have temporarily blocked all of my signals then..","width":330.18181824684143},{"text":"then I want to be able to eat multiple zombies","width":211.18181824684143},{"text":"so here's how we can do that, the better code to do this then is to keep calling waitpid until there's no more zombies left to reap, until there's no more zombies left to find","width":637.1818182468414},{"text":"right so here's the typical way of doing this ","width":135.18181824684143},{"text":"there's a Â flag we can put in here to say actually...","width":584.1818182468414},{"text":"don't wait just return immediately if there is no more children to..","width":534.1818182468414},{"text":"no more zombies to find then let me know about it","width":275.18181824684143},{"text":"[silence]","width":1783.1818182468414},{"text":"and so we better put this inside a loop so here's our plan","width":524.1818182468414},{"text":"we'll say while the exit value is a valid child address","width":375.18181824684143},{"text":"so while this is greater than zero","width":157.18181824684143},{"text":"then I know I've got a valid pid","width":335.18181824684143},{"text":"and go around again","width":87.18181824684143},{"text":"and eventually I'll run out of child processes to reap","width":509.18181824684143},{"text":"okay how we doing for time? good","width":191.18181824684143},{"text":"so now it's your turn","width":193.18181824684143},{"text":"can you remember what to put inside this?","width":152.18181824684143},{"text":"so we've set up our signal hander","width":178.18181824684143},{"text":"how do we correctly install it?","width":194.18181824684143},{"text":"[silence]","width":4762.181818246841},{"text":"okay right so ","width":147.18181824684143},{"text":"we've set up the handler","width":66.18181824684143},{"text":"we better set up this mask","width":133.18181824684143},{"text":"if clearing zombies is the most important thing and we don't want to be interrupted by anything, not even say control C","width":469.18181824684143},{"text":"then let's say that we'll set the mask...","width":829.1818182468414},{"text":"on a...","width":128.18181824684143},{"text":"let's say mask.. what's that? it's going to be sa.sa_mask","width":406.18181824684143},{"text":"[writing]","width":694.1818182468414},{"text":"and then finally flags we could just say zero","width":348.18181824684143},{"text":"but there's something that's useful for real programs which is sa_restart","width":684.1818182468414},{"text":"so if you install signal handlers with sa_restart","width":217.18181824684143},{"text":"you're making your life a little bit easier in the rest of your program","width":267.18181824684143},{"text":"if you were to read say about write or read","width":349.18181824684143},{"text":"other function calls at the system levle","width":195.18181824684143},{"text":"sorry, other system calls","width":118.18181824684143},{"text":"you discover that some of them will simply return immediately without doing anything","width":303.18181824684143},{"text":"and give you an error which is E_interrupted or E_retry","width":282.18181824684143},{"text":"and E_interrupted means hey I was interrupted by a signal so I chose not to do anything","width":358.18181824684143},{"text":"ah thanks operating system, that's really helpful","width":164.18181824684143},{"text":"why don't you try again? do you want to play again?","width":136.18181824684143},{"text":"and so we have to write code that checks for the specific error condition that says I was interrupted and I want to restart","width":563.1818182468414},{"text":"well specifying this restart parameter in here...","width":264.18181824684143},{"text":"makes our programming a little bit easier because the number of times that happens is reduced","width":338.18181824684143},{"text":"it's I'm afraid not 100%","width":173.18181824684143},{"text":"but, it does do the restart for you automatically on some function calls","width":513.1818182468414},{"text":"again it's not worth knowing the big list, it's just worth actually going to say man -s7 signals and reading more about it if you are interested","width":709.1818182468414}]